image: gcc

build:
  stage: build
  before_script:
    - apt update && apt -y upgrade
    - apt -y install automake autoconf make
    - apt -y install puredata-dev puredata-core
    - autoreconf -fiv
  script:
    # build multi-object-binary
    - mkdir -p ${CI_PROJECT_DIR}/build-lib && cd ${CI_PROJECT_DIR}/build-lib
    - ../configure
    - make check
    - make install DESTDIR=${CI_PROJECT_DIR}/ pkglibdir=zexy

    # build multi-object-binary
    - mkdir -p ${CI_PROJECT_DIR}/build-obj && cd ${CI_PROJECT_DIR}/build-obj
    - ../configure --disable-library
    - make check
#  dependencies: []
#  artifacts:
#    name: ${CI_PROJECT_NAME}-snapshot
#    paths:
#      - zexy
#    expire_in: 1 week
